namespace = giga_flavor

#This event will run yearly in every country, and apply flavor events to appropriate megas

country_event = {
	id = giga_flavor.999
	title = "giga_flavor.999.name"
	desc = "giga_flavor.999.desc"
	is_triggered_only = yes

	picture = GFX_evt_fallen_empire
	show_sound = event_mystic_reveal_light

	trigger = {
		NOT = { has_global_flag = already_warned_about_new_megas }
		is_ai = no
	}

	immediate = {
		set_global_flag = already_warned_about_new_megas
	}

	option = {
		name = "giga_flavor.999.a"
	}
}

country_event = {
	id = giga_flavor.1000
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		if = {
			limit = { any_owned_megastructure = { is_megastructure_type = particle_accelerator_1 } }
			country_event = { id = giga_accelerator.100 }
		}
		if = {
			limit = { any_owned_megastructure = { is_megastructure_type = lunar_disco_ball_2 } }
			country_event = { id = giga_disco.100 }
		}
		if = {
			limit = { any_owned_megastructure = { OR = { is_megastructure_type = yggdrasil_orchid_3 is_megastructure_type = yggdrasil_orchid_restored } } }
			country_event = { id = giga_yggdrasil.100 }
		}
	}
}

namespace = giga_yggdrasil
#random event generator
country_event = {
	id = giga_yggdrasil.100
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		every_owned_megastructure = {
			limit = {
				OR = { is_megastructure_type = yggdrasil_orchid_3 is_megastructure_type = yggdrasil_orchid_restored }
				planet = { NOT = { has_planet_flag = giga_mega_event_occured_recently } }
			}
			#random stuff
			random_list = {
				1 = { #Lifeforms eat the food
					planet = {
						set_timed_planet_flag = {
							flag = giga_mega_event_occured_recently
							days = 3600
						}
						save_event_target_as = giga_event_planet
					}
					save_event_target_as = yggdrasil_lifeforms
					owner = { 
						country_event = { id = giga_yggdrasil.140 days = 30 random = 15 }
						set_country_flag = yggdrasil_lifeforms_happened
					}
					set_megastructure_flag = yggdrasil_lifeforms
					modifier = {
						factor = 0
						owner = { has_country_flag = yggdrasil_lifeforms_happened }
					}
					modifier = {
						factor = 0
						has_megastructure_flag = yggdrasil_lifeforms
					}
				}
				1 = { #Storm: reduces output
					planet = {
						set_timed_planet_flag = {
							flag = giga_mega_event_occured_recently
							days = 3600
						}
						save_event_target_as = giga_event_planet
					}
					save_event_target_as = yggdrasil_storm
					owner = { 
						country_event = { id = giga_yggdrasil.130 days = 30 random = 15 }
						set_timed_country_flag = {
							flag = yggdrasil_storm_happened
							days = 1800
						}
					}
					modifier = {
						factor = 0
						owner = {
							has_country_flag = yggdrasil_storm_happened
						}
					}
					modifier = {
						factor = 0
						has_megastructure_flag = yggdrasil_storm
					}
				}
				1 = { #Hallucinogens: Plants mutate to become drugs
					planet = {
						set_timed_planet_flag = {
							flag = giga_mega_event_occured_recently
							days = 3600
						}
						save_event_target_as = giga_event_planet
					}
					save_event_target_as = yggdrasil_drugs
					set_megastructure_flag = yggdrasil_drugs
					owner = { 
						country_event = { id = giga_yggdrasil.110 days = 30 random = 15 }
						set_country_flag = yggdrasil_drugs_happened 
					}
					modifier = {
						factor = 0
						owner = {
							OR = {
								is_gestalt = yes
								has_country_flag = yggdrasil_drugs_happened
							}
						}
					}
					modifier = {
						factor = 0
						has_megastructure_flag = yggdrasil_drugs
					}
				}
				0 = { #Another empire asks for a cut of the production
					planet = {
						set_timed_planet_flag = {
							flag = giga_mega_event_occured_recently
							days = 3600
						}
						save_event_target_as = giga_event_planet
					}
					save_event_target_as = yggdrasil_foodshare
					set_timed_megastructure_flag = {
						flag = yggdrasil_foodshare
						days = 720
					} 
					random_country = {
						limit = { is_valid_yggdrasil_food_beggar = yes }
						save_event_target_as = yggdrasil_food_beggar_country
					}
					owner = {  country_event = { id = giga_yggdrasil.120 days = 10 random = 10 } }
					modifier = {
						factor = 0
						has_megastructure_flag = yggdrasil_foodshare
					}
					modifier = {
						add = 5
						any_country = {
							is_valid_yggdrasil_food_beggar = yes
						}
						ROOT = {
							NOR = {
								has_modifier = yggdrasil_food_share_donator
								has_valid_civic = civic_fanatic_purifiers
								has_valid_civic = civic_hive_devouring_swarm
								has_valid_civic = civic_machine_terminator
							}
						}
					}
				}
				96 = {}
			}
		}
	}
}

#Lifeforms eat the food
country_event = {
	id = giga_yggdrasil.140
	title = "giga_yggdrasil.140.name"
	desc = "giga_yggdrasil.140.desc"

	picture = GFX_evt_alien_nature
	show_sound = event_space_amoeba

	is_triggered_only = yes
	
	location = event_target:giga_event_planet

	option = { #Hunt them
		name = "giga_yggdrasil.140.a"
		custom_tooltip = "giga_yggdrasil.140.a.tooltip"
		hidden_effect = {
			event_target:yggdrasil_lifeforms = {
				set_timed_megastructure_flag = {
					flag = clearing_yggdrasil_locusts
					days = 720
				}
			}
			country_event = { id = giga_yggdrasil.141 days = 720 }
		}
	}

	option = { #Whatever
		name = "giga_yggdrasil.140.b"
		custom_tooltip = "giga_yggdrasil.140.b.tooltip"
		hidden_effect = {
			event_target:yggdrasil_lifeforms = {
				set_timed_megastructure_flag = {
					flag = yggdrasil_locusts
					days = 1800
				}
			}
			country_event = { id = giga_yggdrasil.142 days = 1800 }
		}
	}

	option = { #Preserve
		name = "giga_yggdrasil.140.c"
		custom_tooltip = "giga_yggdrasil.140.c.tooltip"
		hidden_effect = {
			event_target:yggdrasil_lifeforms = {
				set_megastructure_flag = studying_yggdrasil_locusts
			}
		}
	}
}

country_event = {
	id = giga_yggdrasil.141
	title = "giga_yggdrasil.141.name"
	desc = "giga_yggdrasil.141.desc"

	is_triggered_only = yes

	picture = GFX_evt_alien_nature
	show_sound = event_sensor_ping

	option = {
		name = "giga_yggdrasil.141.a"
		add_resource = {
			influence = 25
		}
	}
}

country_event = {
	id = giga_yggdrasil.142
	title = "giga_yggdrasil.142.name"
	desc = "giga_yggdrasil.142.desc"

	is_triggered_only = yes

	picture = GFX_evt_alien_nature
	show_sound = event_sensor_ping

	option = {
		name = "giga_yggdrasil.142.a"
	}
}

#Storm: Reduces production
country_event = {
	id = giga_yggdrasil.130
	title = "giga_yggdrasil.130.name"
	desc = "giga_yggdrasil.130.desc"

	picture = GFX_evt_gas_giant
	show_sound = event_structural_collapse

	is_triggered_only = yes
	
	location = event_target:giga_event_planet

	option = { #Spend energy to fix, will last 2 years
		name = "giga_yggdrasil.130.a"
		custom_tooltip = "giga_yggdrasil.130.a.tooltip"
		allow = {
			resource_stockpile_compare = {
				resource = energy
				value >= 10000
			}
			resource_stockpile_compare = {
				resource = alloys
				value >= 5000
			}
			resource_stockpile_compare = {
				resource = food
				value >= 2500
			}
		}
		add_resource = {
			energy = -10000
			alloys = -5000
			food = -2000
		}
		hidden_effect = {
			event_target:yggdrasil_storm = {
				set_timed_megastructure_flag = {
					flag = yggdrasil_storm
					days = 720
				} 
			}
		}
	}

	option = { #Too bad. Will last 5 years.
		name = "giga_yggdrasil.130.b"
		custom_tooltip = "giga_yggdrasil.130.b.tooltip"
		hidden_effect = {
			event_target:yggdrasil_storm = {
				set_timed_megastructure_flag = {
					flag = yggdrasil_storm
					days = 2700
				} 
			}
		}
	}
}
#Share: A country wants some food
country_event = {
	id = giga_yggdrasil.120
	title = "giga_yggdrasil.120.name"
	desc = "giga_yggdrasil.120.desc"

	diplomatic = yes

	is_triggered_only = yes
	
	location = event_target:yggdrasil_foodshare

	picture_event_data = {
		portrait = event_target:yggdrasil_food_beggar_country
		room = event_target:yggdrasil_food_beggar_country
		planet_background = event_target:yggdrasil_food_beggar_country.capital_scope
	}

	option = { #Sure!
		name = "giga_yggdrasil.120.a"
		custom_tooltip = "giga_yggdrasil.120.a.tooltip"
		add_modifier = {
			modifier = yggdrasil_food_share_donator
			days = 3600
		}
		add_favors = {
			target = event_target:yggdrasil_food_beggar_country
			value = 5
		}
		event_target:yggdrasil_food_beggar_country = {
			add_modifier = {
				modifier = yggdrasil_food_share_recipient
				days = 3600
			}
			add_opinion_modifier = {
				who = root
				modifier = opinion_yggdrasil_gave_food
			}
		}
	}

	option = { #Sure but pay
		name = "giga_yggdrasil.120.b"
		add_modifier = {
			modifier = yggdrasil_food_share_donator
			days = 3600
		}
		add_resource = {
			energy = 15000
		}
		event_target:yggdrasil_food_beggar_country = {
			add_modifier = {
				modifier = yggdrasil_food_share_recipient
				days = 3600
			}
			add_opinion_modifier = {
				who = root
				modifier = opinion_yggdrasil_gave_food_paid
			}
		}
	}

	option = { #Niet
		name = "giga_yggdrasil.120.c"
		add_resource = {
			influence = 50
		}
		event_target:yggdrasil_food_beggar_country = {
			add_opinion_modifier = {
				who = root
				modifier = opinion_yggdrasil_denied_food
			}
		}
	}
}

#Hallucinogens: Plants in orchid mutate to become drugs
country_event = {
	id = giga_yggdrasil.110
	title = "giga_yggdrasil.110.name"
	desc = "giga_yggdrasil.110.desc"

	picture = GFX_evt_space_crystals
	show_sound = event_alien_nature

	is_triggered_only = yes
	
	location = event_target:yggdrasil_drugs

	option = { #Restrict it. Costs energy but less negative effects.
		name = "giga_yggdrasil.110.a"
		custom_tooltip = "giga_yggdrasil.110.a.tooltip"
		add_modifier = {
			modifier = yggdrasil_drugs_restricted
			days = 7200
		}
		if = {
			limit = { has_ethic = ethic_egalitarian }
			add_modifier = {
				modifier = yggdrasil_drugs_displeased
				days = 1800
				multiplier = 1
			}
		}
		if = {
			limit = { has_ethic = ethic_fanatic_egalitarian }
			add_modifier = {
				modifier = yggdrasil_drugs_displeased
				days = 1800
				multiplier = 2
			}
		}
	}

	option = { #Free circulation. No cost but negative effects.
		name = "giga_yggdrasil.110.b"
		custom_tooltip = "giga_yggdrasil.110.b.tooltip"
		add_modifier = {
			modifier = yggdrasil_drugs_free
			days = 7200
		}
		if = {
			limit = { has_ethic = ethic_authoritarian }
			add_modifier = {
				modifier = yggdrasil_drugs_displeased
				days = 1800
				multiplier = 1
			}
		}
		if = {
			limit = { has_ethic = ethic_fanatic_authoritarian }
			add_modifier = {
				modifier = yggdrasil_drugs_displeased
				days = 1800
				multiplier = 2
			}
		}
	}

	option = { #Sell it! Makes trade value.
		name = "giga_yggdrasil.110.c"
		custom_tooltip = "giga_yggdrasil.110.c.tooltip"
		add_modifier = {
			modifier = yggdrasil_drugs_sold
			days = 7200
		}
		trigger = {
			is_authoritarian = no
			is_megacorp = no 
		}
	}

	option = { #Sell it! Makes trade value. (Megacorp)
		name = "giga_yggdrasil.110.e"
		custom_tooltip = "giga_yggdrasil.110.e.tooltip"
		add_modifier = {
			modifier = yggdrasil_drugs_sold_megacorp
			days = 7200
		}
		trigger = {
			is_authoritarian = no
			is_megacorp = yes
		}
	}

	option = { #Destroy it.
		name = "giga_yggdrasil.110.d"
		custom_tooltip = "giga_yggdrasil.110.d.tooltip"
		add_resource = {
			energy = -7500
			food = -2500
			influence = 50
		}
	}
}


namespace = giga_accelerator
#random event generator
country_event = {
	id = giga_accelerator.100
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		every_owned_megastructure = {
			limit = {
				is_megastructure_type = particle_accelerator_1
				planet = { NOT = { has_planet_flag = giga_mega_failure_occured_recently } }
			}
			#failures
			random_list = {
				100 = {
					modifier = { add = -5 planet = { check_variable = { which = giga_failure_chance value = 5 } } }
					modifier = { add = -10 planet = { check_variable = { which = giga_failure_chance value = 10 } } }
					modifier = { add = -15 planet = { check_variable = { which = giga_failure_chance value = 15 } } }
					modifier = { add = -20 planet = { check_variable = { which = giga_failure_chance value = 20 } } }
					modifier = { add = -25 planet = { check_variable = { which = giga_failure_chance value = 25 } } }
					modifier = { add = -30 planet = { check_variable = { which = giga_failure_chance value = 30 } } }
					modifier = { add = -35 planet = { check_variable = { which = giga_failure_chance value = 35 } } }
					modifier = { add = -40 planet = { check_variable = { which = giga_failure_chance value = 30 } } }
					modifier = { add = -45 planet = { check_variable = { which = giga_failure_chance value = 45 } } }
					modifier = { add = -50 planet = { check_variable = { which = giga_failure_chance value = 50 } } }
				}
				0 = {
					solar_system = { save_global_event_target_as = giga_mega_event_system }
					planet = {
						set_timed_planet_flag = {
							flag = giga_mega_failure_occured_recently
							days = 3600
						}
					}
					set_megastructure_flag = giga_acc_under_repair
					owner = { country_event = { id = giga_accelerator.110 days = 10 random = 5 } }
					modifier = { add = 5 planet = { check_variable = { which = giga_failure_chance value = 5 } } }
					modifier = { add = 10 planet = { check_variable = { which = giga_failure_chance value = 10 } } }
					modifier = { add = 15 planet = { check_variable = { which = giga_failure_chance value = 15 } } }
					modifier = { add = 20 planet = { check_variable = { which = giga_failure_chance value = 20 } } }
					modifier = { add = 25 planet = { check_variable = { which = giga_failure_chance value = 25 } } }
					modifier = { add = 30 planet = { check_variable = { which = giga_failure_chance value = 30 } } }
					modifier = { add = 35 planet = { check_variable = { which = giga_failure_chance value = 35 } } }
					modifier = { add = 40 planet = { check_variable = { which = giga_failure_chance value = 30 } } }
					modifier = { add = 45 planet = { check_variable = { which = giga_failure_chance value = 45 } } }
					modifier = { add = 50 planet = { check_variable = { which = giga_failure_chance value = 50 } } }
				}
			}
		}
		every_owned_megastructure = {
			limit = {
				is_megastructure_type = particle_accelerator_1
				planet = { NOT = { has_planet_flag = giga_mega_event_occured_recently } }
			}
			#random stuff
			random_list = {
				5 = { #vacuum fears
					planet = {
						set_timed_planet_flag = {
							flag = giga_mega_event_occured_recently
							days = 3600
						}
					}
					owner = { country_event = { id = giga_accelerator.120 days = 30 random = 180 } }
					modifier = {
						add = -5
						owner = {
							OR = {
								is_gestalt = yes
								has_country_flag = vacuum_fears_happened
							}
						}
					}
				}
				5 = { #quasistar
					planet = {
						set_timed_planet_flag = {
							flag = giga_mega_event_occured_recently
							days = 3600
						}
						set_planet_flag = cannot_dismantle_acc
						save_global_event_target_as = accelerator_quasistar
					}
					owner = { country_event = { id = giga_accelerator.150 days = 30 random = 180 } }
					modifier = {
						add = -5
						has_global_flag = giga_quasi_star_happened
					}
					modifier = {
						factor = 0
						planet = {
							solar_system = {
								any_system_planet = {
									is_capital = yes
								}
							}
						}
					}
				}
				5 = { #good findings
					planet = {
						set_timed_planet_flag = {
							flag = giga_mega_event_occured_recently
							days = 3600
						}
					}
					owner = { country_event = { id = giga_accelerator.130 days = 30 random = 180 } }
				}
				5 = { #dark matter
					planet = {
						set_timed_planet_flag = {
							flag = giga_mega_event_occured_recently
							days = 3600
						}
					}
					owner = { country_event = { id = giga_accelerator.140 days = 30 random = 180 } }
					modifier = {
						factor = 0
						owner = { NOT = { has_technology = tech_mine_dark_matter } }
					}
				}
				80 = {}
			}
		}
	}
}

#quasistar
country_event = {
	id = giga_accelerator.150
	title = "giga_accelerator.150.name"
	desc = "giga_accelerator.150.desc"

	picture = GFX_evt_black_hole
	show_sound = event_yellow_alert

	is_triggered_only = yes

	immediate = {
		set_global_flag = giga_quasi_star_happened
		country_event = { id = giga_accelerator.151 days = 30 }
	}

	option = {
		name = "giga_accelerator.150.a"
		add_monthly_resource_mult = {
			resource = physics_research
			value = @tier4researchreward
			min = @tier4researchmin
			max = @tier4researchmax
		}
		trigger = {
			NOR = {
				has_ethic = ethic_materialist
				has_ethic = ethic_fanatic_materialist
			}
		}
	}

	option = {
		name = "giga_accelerator.150.b"
		add_monthly_resource_mult = {
			resource = physics_research
			value = @tier4researchreward
			min = @tier4researchmin
			max = @tier4researchmax
		}
		trigger = {
			OR = {
				has_ethic = ethic_materialist
				has_ethic = ethic_fanatic_materialist
			}
		}
	}
}

#nom nom
country_event = {
	id = giga_accelerator.151
	title = "giga_accelerator.151.name"
	desc = "giga_accelerator.151.desc"

	picture = GFX_evt_star_yellow
	show_sound = event_solar_fusion

	is_triggered_only = yes

	option = {
		name = "giga_accelerator.151.a"
		hidden_effect = {
			country_event = { id = giga_accelerator.152 days = 3600 }
		}
		add_modifier = {
			modifier = studying_accelerator_black_hole_star
			days = 1800
		}
		event_target:accelerator_quasistar = {
			add_modifier = {
				modifier = giga_quasi_star
				days = -1
			}
		}
		add_monthly_resource_mult = {
			resource = physics_research
			value = @tier5researchreward
			min = @tier5researchmin
			max = @tier5researchmax
		}
	}
}

#wait its speeding up OH NO
country_event = {
	id = giga_accelerator.152
	title = "giga_accelerator.152.name"
	desc = "giga_accelerator.152.desc"

	picture = GFX_evt_black_hole
	show_sound = event_yellow_alert

	is_triggered_only = yes

	option = {
		name = "giga_accelerator.152.a"
		custom_tooltip = "giga_accelerator.152.a.tooltip"
		add_modifier = {
			modifier = studying_accelerator_black_hole_star
			days = 1800
		}
		hidden_effect = {
			country_event = { id = giga_accelerator.154 days = 3600 } #CHANGE TO 10 YEARS
			event_target:accelerator_quasistar = {
				planet_event = { id = giga_accelerator.153 days = 420 }
				if = {
					limit = { planet_size > 1 }
					change_planet_size = -1
				}
				solar_system = {
					every_system_planet = {
						limit = { is_star = no }
						add_modifier = {
							modifier = giga_quasi_star_cooling_planet
							days = -1
						}
					}
				}
			}
		}
		add_monthly_resource_mult = {
			resource = physics_research
			value = @tier5researchreward
			min = @tier5researchmin
			max = @tier5researchmax
		}
	}
}

planet_event = {
	id = giga_accelerator.153
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		if = {
			limit = { planet_size > 1 }
			change_planet_size = -1
		}
		if = {
			limit = { NOT = { has_planet_flag = giga_done_shrinking } }
			planet_event = { id = giga_accelerator.153 days = 420 }
		}
	}
}

#AAAH
country_event = {
	id = giga_accelerator.154
	title = "giga_accelerator.153.name"
	desc = "giga_accelerator.153.desc"

	picture = GFX_evt_black_hole
	show_sound = event_red_alert

	is_triggered_only = yes

	option = {
		name = "giga_accelerator.153.a"
		custom_tooltip = "giga_accelerator.153.a.tooltip"
		add_modifier = {
			modifier = studying_accelerator_black_hole_star
			days = 1800
		}
		hidden_effect = {
			country_event = { id = giga_accelerator.155 days = 3600 }
			event_target:accelerator_quasistar = {
				set_planet_flag = giga_done_shrinking
				solar_system = {
					every_system_planet = {
						limit = { is_star = no }
						remove_modifier = giga_quasi_star_cooling_planet
						add_modifier = {
							modifier = giga_quasi_star_cooling_planet_1
							days = -1
						}
					}
				}
			}
		}
		add_monthly_resource_mult = {
			resource = physics_research
			value = @tier5researchreward
			min = @tier5researchmin
			max = @tier5researchmax
		}
	}
}

#o hey it stopped!
country_event = {
	id = giga_accelerator.155
	title = "giga_accelerator.155.name"
	desc = "giga_accelerator.155.desc"

	picture = GFX_evt_star_red
	show_sound = event_mystic_reveal

	is_triggered_only = yes

	option = {
		name = "giga_accelerator.155.a"
		add_modifier = {
			modifier = studying_accelerator_black_hole_star
			days = 1800
		}
		hidden_effect = {
			country_event = { id = giga_accelerator.156 days = 1800 }
			event_target:accelerator_quasistar = {
				if = {
					limit = { planet_size > 2 }
					change_planet_size = -2
				}
				else = {
					set_planet_size = 1
				}
			}
		}
		add_monthly_resource_mult = {
			resource = physics_research
			value = @tier5researchreward
			min = @tier5researchmin
			max = @tier5researchmax
		}
	}
}

#NOW ITS GETTING LARGER WHAT
country_event = {
	id = giga_accelerator.156
	title = "giga_accelerator.156.name"
	desc = "giga_accelerator.156.desc"

	picture = GFX_evt_star_white
	show_sound = event_yellow_alert

	is_triggered_only = yes

	option = {
		name = "giga_accelerator.156.a"
		custom_tooltip = "giga_accelerator.156.a.tooltip"
		add_modifier = {
			modifier = studying_accelerator_black_hole_star_1
			days = 1800
		}
		hidden_effect = {
			country_event = { id = giga_accelerator.158 days = 3600 }
			event_target:accelerator_quasistar = {
				planet_event = { id = giga_accelerator.157 days = 320 }
				change_planet_size = 3
				solar_system = {
					every_system_planet = {
						limit = { is_star = no }
						remove_modifier = giga_quasi_star_cooling_planet_1
						add_modifier = {
							modifier = giga_quasi_star_cooling_planet
							days = -1
						}
					}
				}
			}
		}
		add_monthly_resource_mult = {
			resource = physics_research
			value = @tier5researchreward
			min = @tier5researchmin
			max = @tier5researchmax
		}
	}
}

planet_event = {
	id = giga_accelerator.157
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		change_planet_size = 1
		if = {
			limit = { NOT = { has_planet_flag = giga_done_growing } }
			planet_event = { id = giga_accelerator.157 days = 320 }
		}
	}
}

#WHY
country_event = {
	id = giga_accelerator.158
	title = "giga_accelerator.158.name"
	desc = "giga_accelerator.158.desc"

	picture = GFX_evt_star_yellow
	show_sound = event_red_alert

	is_triggered_only = yes

	option = {
		name = "giga_accelerator.158.a"
		custom_tooltip = "giga_accelerator.158.a.tooltip"
		add_modifier = {
			modifier = studying_accelerator_black_hole_star_1
			days = 1800
		}
		hidden_effect = {
			country_event = { id = giga_accelerator.160 days = 2700 }
			event_target:accelerator_quasistar = {
				solar_system = {
					every_system_planet = {
						limit = { is_star = no }
						remove_modifier = giga_quasi_star_cooling_planet
					}
				}
			}
		}
		add_monthly_resource_mult = {
			resource = physics_research
			value = @tier5researchreward
			min = @tier5researchmin
			max = @tier5researchmax
		}
	}
}

#RIP the accelerator
country_event = {
	id = giga_accelerator.160
	title = "giga_accelerator.160.name"
	desc = "giga_accelerator.160.desc"

	picture = GFX_evt_exploding_ship
	show_sound = event_ship_explosion

	is_triggered_only = yes

	option = {
		name = "giga_accelerator.160.a"
		custom_tooltip = "giga_accelerator.160.a.tooltip"
		add_modifier = {
			modifier = studying_accelerator_black_hole_star_1
			days = 1800
		}
		event_target:accelerator_quasistar = {
			add_deposit = d_physics_10
			add_deposit = d_physics_10
			add_deposit = d_physics_10
			add_deposit = d_physics_10
			solar_system = {
				every_system_planet = {
					limit = {
						is_planet_habitable = no
						is_star = no
					}
					add_deposit = d_physics_6
				}
			}
		}
		hidden_effect = {
			subtract_variable = { which = giga_current_accelerator value = 1 }
			event_target:accelerator_quasistar = {
				set_planet_flag = giga_done_growing
				remove_planet_flag = cannot_dismantle_acc
				remove_planet_flag = has_megastructure
				remove_planet_flag = megastructure
				solar_system = {
					every_system_planet = {
						limit = { is_star = no }
						add_modifier = {
							modifier = giga_quasi_star_heating_planet
							days = -1
						}
					}
					random_system_megastructure = {
						limit = {
							planet = { is_same_value = event_target:accelerator_quasistar }
							OR = {
								is_megastructure_type = particle_accelerator_0
								is_megastructure_type = particle_accelerator_1
								is_megastructure_type = particle_accelerator_1_manage
							}
						}
						remove_megastructure = THIS
					}
				}
			}
		}
		add_resource = {
			alloys = 4000
		}
		add_monthly_resource_mult = {
			resource = physics_research
			value = @tier5researchreward
			min = @tier5researchmin
			max = @tier5researchmax
		}
	}
}

#dark matter
country_event = {
	id = giga_accelerator.140
	title = "giga_accelerator.140.name"
	desc = "giga_accelerator.140.desc"

	picture = GFX_evt_surreal_visions
	show_sound = event_mystic_reveal

	is_triggered_only = yes

	option = {
		name = "giga_accelerator.140.a"
		add_resource = {
			sr_dark_matter = 50
		}
	}

	option = {
		name = "giga_accelerator.130.b"
		add_resource = {
			sr_dark_matter = 50
		}
		add_modifier = {
			modifier = gave_accelerator_scientists_raise
			days = 360
		}
		trigger = {
			NOR = {
				is_gestalt = yes
				has_ethic = ethic_fanatic_authoritarian
			}
		}
	}
}

#good findings (wholesome)
country_event = {
	id = giga_accelerator.130
	title = "giga_accelerator.130.name"
	desc = "giga_accelerator.130.desc"

	picture = GFX_evt_physics_research
	show_sound = event_laboratory_sound

	is_triggered_only = yes

	option = {
		name = "giga_accelerator.130.a"
		add_monthly_resource_mult = {
			resource = physics_research
			value = @tier5researchreward
			min = @tier5researchmin
			max = @tier5researchmax
		}
	}

	option = {
		name = "giga_accelerator.130.b"
		add_monthly_resource_mult = {
			resource = physics_research
			value = @tier5researchreward
			min = @tier5researchmin
			max = @tier5researchmax
		}
		add_modifier = {
			modifier = gave_accelerator_scientists_raise
			days = 360
		}
		trigger = {
			NOR = {
				is_gestalt = yes
				has_ethic = ethic_fanatic_authoritarian
			}
		}
	}
}

#vacuum fears
country_event = {
	id = giga_accelerator.120
	title = "giga_accelerator.120.name"
	desc = "giga_accelerator.120.desc"

	picture = GFX_evt_physics_research
	show_sound = event_conversation

	is_triggered_only = yes

	immediate = {
		set_country_flag = vacuum_fears_happened
	}

	option = {
		name = "giga_accelerator.120.a"
		custom_tooltip = "giga_accelerator.120.a.tooltip"
		hidden_effect = {
			random_list = {
				50 = {
					country_event = { id = giga_accelerator.121 days = 720 }
				}
				50 = {
					country_event = { id = giga_accelerator.122 days = 720 }
				}
			}
		}
		add_modifier = {
			modifier = conducting_false_vacuum_study
			days = 720
		}
		add_modifier = {
			modifier = false_vacuum_fears
			days = -1
		}
	}

	option = {
		name = "giga_accelerator.120.b"
		custom_tooltip = "giga_accelerator.120.b.tooltip"
		trigger = {
			NOR = {
				has_ethic = ethic_egalitarian
				has_ethic = ethic_fanatic_egalitarian
			}
		}
		add_modifier = {
			modifier = censored_vacuum_fears
			days = 1800
		}
	}

	option = {
		name = "giga_accelerator.120.c"
		add_modifier = {
			modifier = false_vacuum_fears
			days = 3600
		}
	}

	option = {
		name = "giga_accelerator.120.d"
		custom_tooltip = "giga_accelerator.120.d.tooltip"
		hidden_effect = {
			every_owned_megastructure = {
				limit = { is_megastructure_type = particle_accelerator_1 }
				planet = {
					remove_planet_flag = megastructure
					remove_planet_flag = has_megastructure
					if = { limit = { has_planet_flag = giga_mega_event_occured_recently } remove_planet_flag = giga_mega_event_occured_recently }
					if = { limit = { has_planet_flag = giga_under_repair } remove_planet_flag = giga_under_repair }
				}
				owner = {
					subtract_variable = { which = giga_current_accelerator value = 1 }
					add_resource = { alloys = 3500 }
				}
				remove_megastructure = THIS
			}
		}
	}
}

#Its false!
country_event = {
	id = giga_accelerator.121
	title = "giga_accelerator.121.name"
	desc = "giga_accelerator.121.desc"

	is_triggered_only = yes

	picture = GFX_evt_physics_research
	show_sound = event_laboratory_sound

	option = {
		name = "giga_accelerator.121.a"
		remove_modifier = false_vacuum_fears
		add_modifier = {
			modifier = false_vacuum_study
			days = -1
		}
	}
}

#ITS TRUE OH GOD OH FUCK
country_event = {
	id = giga_accelerator.122
	title = "giga_accelerator.122.name"
	desc = "giga_accelerator.122.desc"

	is_triggered_only = yes

	picture = GFX_evt_zro_3
	show_sound = event_red_alert

	option = {
		name = "giga_accelerator.122.a"
		custom_tooltip = "giga_accelerator.122.a.tooltip"
		remove_modifier = false_vacuum_fears
		add_modifier = {
			modifier = false_vacuum_study
			days = -1
		}
		hidden_effect = {
			random_list = {
				50 = {
					country_event = { id = giga_accelerator.123 days = 60 random = 5 } #they find out
					modifier = {
						add = 10
						has_ethic = ethic_egalitarian
					}
					modifier = {
						add = 20
						has_ethic = ethic_fanatic_egalitarian
					}
					modifier = {
						add = -10
						has_ethic = ethic_authoritarian
					}
					modifier = {
						add = -20
						has_ethic = ethic_fanatic_authoritarian
					}
				}
				50 = {}
			}
		}
	}

	option = {
		name = "giga_accelerator.122.b"
		remove_modifier = false_vacuum_fears
		add_modifier = {
			modifier = false_vacuum_fears
			days = 3600
		}
		add_modifier = {
			modifier = false_vacuum_study
			days = -1
		}
	}

	option = {
		name = "giga_accelerator.122.c"
		custom_tooltip = "giga_accelerator.120.d.tooltip"
		remove_modifier = false_vacuum_fears
		add_modifier = {
			modifier = false_vacuum_study
			days = -1
		}
		hidden_effect = {
			every_owned_megastructure = {
				limit = { is_megastructure_type = particle_accelerator_1 }
				planet = {
					remove_planet_flag = megastructure
					remove_planet_flag = has_megastructure
					if = { limit = { has_planet_flag = giga_mega_event_occured_recently } remove_planet_flag = giga_mega_event_occured_recently }
					if = { limit = { has_planet_flag = giga_under_repair } remove_planet_flag = giga_under_repair }
				}
				owner = {
					subtract_variable = { which = giga_current_accelerator value = 1 }
					add_resource = { alloys = 3500 }
				}
				remove_megastructure = THIS
			}
		}
	}
}

country_event = {
	id = giga_accelerator.123
	title = "giga_accelerator.123.name"
	desc = "giga_accelerator.123.desc"

	is_triggered_only = yes

	picture = GFX_evt_burning_settlement
	show_sound = event_planetary_riot

	option = {
		name = "giga_accelerator.123.a"
		add_modifier = {
			modifier = false_vacuum_fears
			days = 3600
		}
	}

	option = {
		name = "giga_accelerator.123.b"
		custom_tooltip = "giga_accelerator.120.d.tooltip"
		hidden_effect = {
			every_owned_megastructure = {
				limit = { is_megastructure_type = particle_accelerator_1 }
				planet = {
					remove_planet_flag = megastructure
					remove_planet_flag = has_megastructure
					if = { limit = { has_planet_flag = giga_mega_event_occured_recently } remove_planet_flag = giga_mega_event_occured_recently }
					if = { limit = { has_planet_flag = giga_under_repair } remove_planet_flag = giga_under_repair }
				}
				owner = {
					subtract_variable = { which = giga_current_accelerator value = 1 }
					add_resource = { alloys = 3500 }
				}
				remove_megastructure = THIS
			}
		}
	}
}

#random overheating
country_event = {
	id = giga_accelerator.110
	title = "giga_accelerator.110.name"
	desc = "giga_accelerator.110.desc"

	picture = GFX_evt_glitchy_matrix
	show_sound = event_sensor_ping

	location = event_target:giga_mega_event_system
	is_triggered_only = yes

	option = {
		name = "giga_accelerator.110.a"
		custom_tooltip = "giga_accelerator.110.a.tooltip"
		add_resource = {
			alloys = -3000
		}
		allow = {
			resource_stockpile_compare = {
				resource = alloys
				value >= 3000
			}
		}
		hidden_effect = {
			event_target:giga_mega_event_system = {
				random_system_megastructure = {
					limit = { has_megastructure_flag = giga_acc_under_repair }
					planet = {
						while = {
							limit = {
								check_variable = {
									which = acc_intensity
									value > 1
								}
							}
							subtract_variable = {
								which = acc_intensity
								value = 1
							}
							subtract_variable = {
								which = giga_failure_chance
								value = 5
							}
						}
						set_timed_planet_flag = {
							flag = giga_under_repair
							days = 180
						}
						planet_event = { id = giga_accelerator.111 days = 180 }
					}
				}
			}
		}
	}

	option = {
		name = "giga_accelerator.110.b"
		custom_tooltip = "giga_accelerator.110.b.tooltip"
		hidden_effect = {
			event_target:giga_mega_event_system = {
				random_system_megastructure = {
					limit = { has_megastructure_flag = giga_acc_under_repair }
					planet = {
						while = {
							limit = {
								check_variable = {
									which = acc_intensity
									value > 2
								}
							}
							subtract_variable = {
								which = acc_intensity
								value = 1
							}
							subtract_variable = {
								which = giga_failure_chance
								value = 5
							}
						}
						set_timed_planet_flag = {
							flag = giga_under_repair
							days = 360
						}
						random_list = {
							80 = {
								planet_event = { id = giga_accelerator.111 days = 200 random = 30 }
							}
							20 = {
								planet_event = { id = giga_accelerator.112 days = 360 }
							}
						}
					}
				}
			}
		}
	}

	option = {
		name = "giga_accelerator.110.c"
		custom_tooltip = "giga_accelerator.110.c.tooltip"
		hidden_effect = {
			event_target:giga_mega_event_system = {
				random_system_megastructure = {
					limit = { has_megastructure_flag = giga_acc_under_repair }
					planet = {
						random_list = {
							50 = {
								solar_system = {
									random_system_megastructure = {
										limit = { has_megastructure_flag = giga_acc_under_repair }
										remove_megastructure_flag = giga_acc_under_repair
									}
								}
							}
							50 = {
								planet_event = { id = giga_accelerator.112 days = 100 random = 30 }
							}
						}
					}
				}
			}
		}
	}
}

planet_event = {
	id = giga_accelerator.111
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		has_planet_flag = giga_under_repair
	}

	immediate = {
		remove_planet_flag = giga_under_repair
		set_variable = {
			which = acc_intensity
			value = 3
		}
		solar_system = {
			space_owner = { country_event = { id = giga_accelerator.1111 } }
			save_global_event_target_as = giga_mega_event_system_name
			random_system_megastructure = {
				limit = { has_megastructure_flag = giga_acc_under_repair }
				remove_megastructure_flag = giga_acc_under_repair
			}
		}
	}
}


country_event = {
	id = giga_accelerator.1111
	title = "giga_accelerator.111.name"
	desc = "giga_accelerator.111.desc"
	location = event_target:giga_mega_event_system_name
	picture = GFX_evt_megastructure_construction
	show_sound = event_construction
	is_triggered_only = yes

	option = {
		name = "giga_accelerator.111.a"
	}
}

#it blows up :(
planet_event = {
	id = giga_accelerator.112
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		has_planet_flag = giga_mega_event_occured_recently
	}

	immediate = {
		remove_planet_flag = giga_mega_event_occured_recently
		solar_system = {
			space_owner = { country_event = { id = giga_accelerator.1121 } subtract_variable = { which = giga_current_accelerator value = 1 } }
			save_global_event_target_as = giga_mega_event_system_name
			random_system_megastructure = {
				limit = { has_megastructure_flag = giga_acc_under_repair }
				remove_megastructure_flag = giga_acc_under_repair
				remove_megastructure = THIS
			}
			spawn_megastructure = {
				type = particle_accelerator_ruined
				owner = space_owner
				coords_from = ROOT
			}
		}
	}
}

country_event = {
	id = giga_accelerator.1121
	title = "giga_accelerator.112.name"
	desc = "giga_accelerator.112.desc"
	location = event_target:giga_mega_event_system_name
	picture = GFX_evt_exploding_ship
	show_sound = event_ship_explosion
	is_triggered_only = yes

	option = {
		name = "giga_accelerator.112.a"
		custom_tooltip = "giga_accelerator.112.a.tooltip"
	}
}

#mega ui
country_event = {
	id = giga_accelerator.1000
	title = "giga_accelerator.1000.name"
	desc = "giga_accelerator.1000.desc"

	diplomatic = yes
	custom_gui = "giga_accelerator_gui"
	is_triggered_only = yes

	trigger = {
		NOT = { has_global_flag = managing_giga_megastructure }
	}

	option = {
		name = EXIT
		hidden_effect = {
			remove_global_flag = managing_giga_megastructure
		}
	}
}

country_event = { #Dismantle
	id = giga_accelerator.2000
	title = "giga_accelerator.2000.name"
	desc = "giga_accelerator.2000.desc"
	is_triggered_only = yes
	show_sound = event_construction
	picture = GFX_evt_megastructure_construction

	trigger = {
		NOT = { has_global_flag = giga_dismantling_megastructure }
	}

	immediate = {
		set_global_flag = giga_dismantling_megastructure
	}

	option = {
		name = "giga_flavor.2000.yes"
		custom_tooltip = "giga_accelerator.2000.tooltip"
		add_resource = {
			alloys = 3500
		}
		hidden_effect = {
			remove_global_flag = giga_dismantling_megastructure
			remove_global_flag = managing_giga_megastructure
			subtract_variable = { which = giga_current_accelerator value = 1 }
			event_target:giga_mega_manage_planet = {
				planet = {
					if = { limit = { has_planet_flag = giga_mega_event_occured_recently } remove_planet_flag = giga_mega_event_occured_recently }
					if = { limit = { has_planet_flag = giga_under_repair } remove_planet_flag = giga_under_repair }
					remove_planet_flag = megastructure
					remove_planet_flag = has_megastructure
				}
				solar_system = {
					random_system_megastructure = {
						limit = {
							planet = { is_same_value = event_target:giga_mega_manage_planet }
							OR = {
								is_megastructure_type = particle_accelerator_0
								is_megastructure_type = particle_accelerator_1
								is_megastructure_type = particle_accelerator_1_manage
							}
						}
						remove_megastructure = THIS
					}
				}
			}
		}
	}

	option = { #NO
		name = "giga_flavor.2000.forgetit"
		hidden_effect = {
			remove_global_flag = giga_dismantling_megastructure
		}
	}
}


#######DISCO BALL######
namespace = giga_disco
#random event generator
country_event = {
	id = giga_disco.100
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		every_owned_megastructure = {
			limit = {
				is_megastructure_type = lunar_disco_ball_2
				planet = { NOT = { has_planet_flag = giga_mega_failure_occured_recently } }
			}
			#failures
			random_list = {
				100 = {
					modifier = { add = -5 planet = { check_variable = { which = giga_failure_chance value = 5 } } }
					modifier = { add = -10 planet = { check_variable = { which = giga_failure_chance value = 10 } } }
					modifier = { add = -15 planet = { check_variable = { which = giga_failure_chance value = 15 } } }
					modifier = { add = -20 planet = { check_variable = { which = giga_failure_chance value = 20 } } }
					modifier = { add = -25 planet = { check_variable = { which = giga_failure_chance value = 25 } } }
					modifier = { add = -30 planet = { check_variable = { which = giga_failure_chance value = 30 } } }
					modifier = { add = -35 planet = { check_variable = { which = giga_failure_chance value = 35 } } }
					modifier = { add = -40 planet = { check_variable = { which = giga_failure_chance value = 30 } } }
					modifier = { add = -45 planet = { check_variable = { which = giga_failure_chance value = 45 } } }
					modifier = { add = -50 planet = { check_variable = { which = giga_failure_chance value = 50 } } }
				}
				0 = {
					solar_system = { save_global_event_target_as = giga_mega_event_system }
					planet = {
						set_timed_planet_flag = {
							flag = giga_mega_failure_occured_recently
							days = 2700
						}
					}
					set_megastructure_flag = giga_disco_under_repair
					owner = { country_event = { id = giga_disco.110 days = 10 random = 5 } }
					modifier = { add = 5 planet = { check_variable = { which = giga_failure_chance value = 5 } } }
					modifier = { add = 10 planet = { check_variable = { which = giga_failure_chance value = 10 } } }
					modifier = { add = 15 planet = { check_variable = { which = giga_failure_chance value = 15 } } }
					modifier = { add = 20 planet = { check_variable = { which = giga_failure_chance value = 20 } } }
					modifier = { add = 25 planet = { check_variable = { which = giga_failure_chance value = 25 } } }
					modifier = { add = 30 planet = { check_variable = { which = giga_failure_chance value = 30 } } }
					modifier = { add = 35 planet = { check_variable = { which = giga_failure_chance value = 35 } } }
					modifier = { add = 40 planet = { check_variable = { which = giga_failure_chance value = 30 } } }
					modifier = { add = 45 planet = { check_variable = { which = giga_failure_chance value = 45 } } }
					modifier = { add = 50 planet = { check_variable = { which = giga_failure_chance value = 50 } } }
				}
			}
		}
		every_owned_megastructure = {
			limit = {
				is_megastructure_type = lunar_disco_ball_2
				planet = { NOT = { has_planet_flag = giga_mega_event_occured_recently } }
			}
			#random stuff
			random_list = {
				0 = { #pro-nighters
					planet = {
						set_timed_planet_flag = {
							flag = giga_mega_event_occured_recently
							days = 3600
						}
						solar_system = {
							random_system_planet = {
								limit = {
									has_modifier = disco_moon_nonight_modifier
									is_colony = yes
									owner = { NOT = { is_country_type = primitive } }
									OR = {
										any_moon = {
											check_variable = {
												which = giga_disco_moon_setting
												value = 3
											}
										}
										solar_system = {
											any_system_planet = {
												any_moon = { is_same_value = PREVPREVPREV }
												check_variable = {
													which = giga_disco_moon_setting
													value = 3
												}
											}
										}
									}
								}
								set_planet_flag = pronight_protests
								save_global_event_target_as = giga_pronight_protests_planet
							}
						}
					}
					owner = { country_event = { id = giga_disco.120 days = 180 random = 60 } }
					modifier = {
						add = 25
						planet = {
							OR = {
								any_moon = {
									is_colony = yes
									owner = { NOT = { is_country_type = primitive } }
									has_modifier = disco_moon_nonight_modifier
								}
								solar_system = {
									any_system_planet = {
										any_moon = { is_same_value = PREVPREVPREV }
										has_modifier = disco_moon_nonight_modifier
										is_colony = yes
										owner = { NOT = { is_country_type = primitive } }
									}
								}
							}
						}
					}
					modifier = {
						factor = 0
						owner = {
							is_gestalt = yes
						}
					}
					modifier = {
						factor = 1.5
						owner = {
							has_ethic = ethic_egalitarian
						}
					}
					modifier = {
						factor = 3
						owner = {
							has_ethic = ethic_fanatic_egalitarian
						}
					}
					modifier = {
						factor = 0.75
						owner = {
							has_ethic = ethic_authoritarian
						}
					}
					modifier = {
						factor = 0.5
						owner = {
							has_ethic = ethic_fanatic_authoritarian
						}
					}
				}
				200 = {}
			}
		}
	}
}

#random overheating
country_event = {
	id = giga_disco.110
	title = "giga_disco.110.name"
	desc = "giga_disco.110.desc"

	picture = GFX_evt_glitchy_matrix
	show_sound = event_sensor_ping

	location = event_target:giga_mega_event_system
	is_triggered_only = yes

	option = {
		name = "giga_disco.110.a"
		custom_tooltip = "giga_disco.110.a.tooltip"
		add_resource = {
			alloys = -1500
			rare_crystals = -1000
		}
		allow = {
			resource_stockpile_compare = {
				resource = alloys
				value >= 1500
			}
			resource_stockpile_compare = {
				resource = rare_crystals
				value >= 500
			}
		}
		hidden_effect = {
			event_target:giga_mega_event_system = {
				random_system_megastructure = {
					limit = { has_megastructure_flag = giga_disco_under_repair }
					planet = {
						save_global_event_target_as = giga_mega_manage_planet
						solar_system = {
							every_galaxy_planet = {
								limit = { any_moon = { is_planet = event_target:giga_mega_manage_planet } }
								clear_disco_moon_modifiers = yes
								every_moon = { clear_disco_moon_modifiers = yes }
							}
						}
						clear_disco_moon_modifiers = yes
						set_variable = {
							which = giga_disco_moon_setting
							value = 4
						}
						set_variable = {
							which = giga_failure_chance
							value = 0
						}
						set_timed_planet_flag = {
							flag = giga_disco_under_repair
							days = 360
						}
						planet_event = { id = giga_disco.111 days = 360 }
					}
				}
			}
		}
	}

	option = {
		name = "giga_disco.110.b"
		custom_tooltip = "giga_disco.110.b.tooltip"
		hidden_effect = {
			event_target:giga_mega_event_system = {
				random_system_megastructure = {
					limit = { has_megastructure_flag = giga_disco_under_repair }
					planet = {
						random_list = {
							50 = {
								solar_system = {
									random_system_megastructure = {
										limit = { has_megastructure_flag = giga_disco_under_repair }
										remove_megastructure_flag = giga_disco_under_repair
									}
								}
							}
							50 = {
								planet_event = { id = giga_disco.112 days = 100 random = 30 }
							}
						}
					}
				}
			}
		}
	}
}

planet_event = {
	id = giga_disco.111
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		has_planet_flag = giga_disco_under_repair
	}

	immediate = {
		remove_planet_flag = giga_disco_under_repair
		planet = {
			add_modifier = {
				modifier = disco_moon_modifier
				days = -1
			}
			solar_system = {
				every_galaxy_planet = {
					limit = { any_moon = { is_same_value = PREVPREVPREV } }
					add_modifier = {
						modifier = disco_moon_modifier
						days = -1
					}
					every_moon = {
						limit = { NOT = { is_planet_class = pc_disco_moon } }
						add_modifier = {
							modifier = disco_moon_modifier
							days = -1
						}
					}
				}
			}
		}
		set_variable = {
			which = giga_disco_moon_setting
			value = 0
		}
		set_variable = {
			which = giga_failure_chance
			value = 5
		}
		solar_system = {
			space_owner = { country_event = { id = giga_disco.1111 } }
			save_global_event_target_as = giga_mega_event_system_name
			random_system_megastructure = {
				limit = { has_megastructure_flag = giga_disco_under_repair }
				remove_megastructure_flag = giga_disco_under_repair
			}
		}
	}
}


country_event = {
	id = giga_disco.1111
	title = "giga_disco.111.name"
	desc = "giga_disco.111.desc"
	location = event_target:giga_mega_event_system_name
	picture = GFX_evt_megastructure_construction
	show_sound = event_construction
	is_triggered_only = yes

	option = {
		name = "giga_disco.111.a"
	}
}

#it blows up :(
planet_event = {
	id = giga_disco.112
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		has_planet_flag = giga_mega_event_occured_recently
	}

	immediate = {
		remove_planet_flag = giga_mega_event_occured_recently
		solar_system = {
			space_owner = { country_event = { id = giga_disco.1121 } subtract_variable = { which = giga_current_disco_moon value = 1 } }
			save_global_event_target_as = giga_mega_event_system_name
			random_system_megastructure = {
				limit = { has_megastructure_flag = giga_disco_under_repair }
				remove_megastructure_flag = giga_disco_under_repair
				remove_megastructure = THIS
				planet = {
					clear_disco_moon_modifiers = yes
					every_moon = {
						limit = { NOT = { is_planet_class = pc_disco_moon } }
						clear_disco_moon_modifiers = yes
					}
					remove_planet_flag = megastructure
					remove_planet_flag = has_megastructure
					if = { limit = { has_planet_flag = giga_mega_event_occured_recently } remove_planet_flag = giga_mega_event_occured_recently }
					if = { limit = { has_planet_flag = giga_disco_under_repair } remove_planet_flag = giga_under_repair }
					change_pc = pc_molten
				}
			}
		}
	}
}

country_event = {
	id = giga_disco.1121
	title = "giga_disco.112.name"
	desc = "giga_disco.112.desc"
	location = event_target:giga_mega_event_system_name
	picture = GFX_evt_exploding_ship
	show_sound = event_ship_explosion
	is_triggered_only = yes

	option = {
		name = "giga_disco.112.a"
		custom_tooltip = "giga_disco.112.a.tooltip"
	}
}


#pronighters want the night back
country_event = {
	id = giga_disco.120
	title = "giga_disco.120.name"
	desc = "giga_disco.120.desc"
	location = event_target:giga_pronight_protests_planet
	picture = GFX_evt_civil_action
	show_sound = event_planetary_riot
	is_triggered_only = yes

	option = {
		name = "giga_disco.120.a"
		event_target:giga_pronight_protests_planet = {
			add_modifier = {
				modifier = pronight_protests
				days = 1800
			}
		}
	}

	option = {
		name = "giga_disco.120.b"
		custom_tooltip = "giga_disco.120.b.tooltip"
		hidden_effect = {
			event_target:giga_pronight_protests_planet = {
				clear_disco_moon_modifiers = yes
				every_moon = {
					limit = { NOT = { is_planet_class = pc_disco_moon } }
					clear_disco_moon_modifiers = yes
					add_modifier = {
						modifier = disco_moon_modifier
						days = -1
					}
				}
				add_modifier = {
					modifier = disco_moon_modifier
					days = -1
				}
				every_moon = {
					limit = {
						is_planet_class = pc_disco_moon
						check_variable = {
							which = giga_disco_moon_setting
							value = 3
						}
					}
					set_variable = {
						which = giga_disco_moon_setting
						value = 0
					}
					subtract_variable = {
						which = giga_failure_chance
						value = 15
					}
					set_timed_planet_flag = {
						flag = cant_nonight_protocols
						days = 3600
					}
				}
				solar_system = {
					every_system_planet = {
						limit = {
							is_planet_class = pc_disco_moon
							check_variable = {
								which = giga_disco_moon_setting
								value = 3
							}
							any_moon = { is_same_value = event_target:giga_pronight_protests_planet }
						}
						set_variable = {
							which = giga_disco_moon_setting
							value = 0
						}
						subtract_variable = {
							which = giga_failure_chance
							value = 15
						}
						set_timed_planet_flag = {
							flag = cant_nonight_protocols
							days = 3600
						}
					}
				}
			}
		}
	}
}

#mega ui
country_event = {
	id = giga_disco.1000
	title = "giga_disco.1000.name"
	desc = "giga_disco.1000.desc"

	diplomatic = yes
	custom_gui = "giga_disco_gui"
	is_triggered_only = yes

	trigger = {
		NOT = { has_global_flag = managing_giga_megastructure }
	}

	option = {
		name = EXIT
		hidden_effect = {
			remove_global_flag = managing_giga_megastructure
		}
	}
}

country_event = { #Dismantle
	id = giga_disco.2000
	title = "giga_disco.2000.name"
	desc = "giga_disco.2000.desc"
	is_triggered_only = yes
	show_sound = event_construction
	picture = GFX_evt_megastructure_construction

	trigger = {
		NOT = { has_global_flag = giga_dismantling_megastructure }
	}

	immediate = {
		set_global_flag = giga_dismantling_megastructure
	}

	option = {
		name = "giga_disco.2000.yes"
		custom_tooltip = "giga_disco.2000.tooltip"
		add_resource = {
			alloys = 2000
			rare_crystals = 500
		}
		hidden_effect = {
			remove_global_flag = giga_dismantling_megastructure
			remove_global_flag = managing_giga_megastructure
			subtract_variable = { which = giga_current_disco_moon value = 1 }
			event_target:giga_mega_manage_planet = {
				planet = {
					if = { limit = { has_planet_flag = giga_mega_event_occured_recently } remove_planet_flag = giga_mega_event_occured_recently }
					if = { limit = { has_planet_flag = giga_disco_under_repair } remove_planet_flag = giga_under_repair }
					remove_planet_flag = megastructure
					remove_planet_flag = has_megastructure
					change_pc = pc_barren_cold
					clear_disco_moon_modifiers = yes
					every_moon = {
						limit = { NOT = { is_planet_class = pc_disco_moon } }
						clear_disco_moon_modifiers = yes
					}
				}
				solar_system = {
					random_system_megastructure = {
						limit = {
							planet = { is_same_value = event_target:giga_mega_manage_planet }
							OR = {
								is_megastructure_type = lunar_disco_ball_2
								is_megastructure_type = lunar_disco_ball_1
								is_megastructure_type = lunar_disco_ball_2_manage
							}
						}
						remove_megastructure = THIS
					}
				}
			}
		}
	}

	option = { #NO
		name = "giga_flavor.2000.forgetit"
		hidden_effect = {
			remove_global_flag = giga_dismantling_megastructure
		}
	}
}